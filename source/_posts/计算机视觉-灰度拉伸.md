---
title: '[计算机视觉]灰度拉伸 & 直方图均衡化'
date: 2024-05-06 22:21:57
tags:
- 灰度拉伸
- 直方图均衡化
categories: 
- 计算机视觉
- 点操作
---

# 1.灰度拉伸

有两种

- **线性拉伸**：将灰度范围线性扩展

- **非线性拉伸**：将感兴趣的灰度范围线性扩展，相对抑制不感兴趣的灰度区域

## 1.1 效果

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062223406.png)

**线性点运算作用:**

1. 当图象成像时曝光不足或过度,
2. 成像设备的非线性
3. 图像记录设备动态范围太窄等原因，都会产生对比度不足的弊病，使图像中的细节分辨不清。这时可通过点运算将灰度范围线性扩展.

## 1.2 原理

### 1.2.1 线性拉伸

即进行线性点运算，输出灰度级与输入灰度级呈线性关系的点运算：

$$D_B=f(D_A)=aD_A+b$$

- 其中，$D_A$ 代表的是二维图像上的灰度值
- $D_B$ 代表的是拉伸后二维图像上的灰度值
- $a$ 是线性方程的**系数**
- $b$ 是线性方程的**截距**

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062238834.png)

------------------

很自然需要分情况讨论，$a<0$ 、 $0<a<1$ 、 $a=1$ 和 $a>1$ 以及 $b=0$ 、 $b>0$ 和 $b<0$

- 当$a<0, b=0$时，输出图像的暗区域将变亮，亮区域将变暗，**反色效果**
  - 注意如果$-1<a<0$，反色后还是有压缩对比度效果
  - 从直方图角度看，直方图的柱子在x轴下方了

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062318235.png)

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062317275.png)

- 当$0<a<1, b=0$时，输出图像的对比度减小，**压缩对比度**

  - 适用于原图灰度的动态范围太大的情况
  - 从直方图角度看，直方图的柱子群分布范围变窄了，但是直方图的形状**压缩**了

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062302707.png)

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062306112.png)

- 当$a=1, b>0$时，图像整体**增亮**
- 当$a=1, b<0$时，图像整体**变暗**

  - 使所有像素的灰度值上移或下移
  - 其效果是使整个图像更暗或更亮
  - 从直方图角度看，就是整个柱子群向255**平移**或者向0**平移**，分布范围不变

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062320395.png)

- 当$a>1$时，输出图像的对比度拉伸，**拉伸对比度**
  - 可使图像动态范围增大，图像对比度扩展。
  - 从而使图像变得清晰以及图像上的特征变得明显
  - 从直方图角度看，就是整个柱子群柱子群分布范围变宽了，直方图的形状被**拉伸**了

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062307636.png)

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405062307201.png)

---------------------------------------------

**直方图角度理解拉伸和压缩：**

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405070012044.png)

可以看到形状还是那个形状

### 1.2.2 分段线性拉伸

**突出**感兴趣的目标或灰度区间，**相对抑制**那些不感兴趣的灰度区间

$$g(x,y)=\begin{cases}\frac{M_g-d}{M_f-b} [f(x,y)-b]+d&b\leq f(x,y)\leq M_f\\[2ex]\frac{d-c}{b-a} [f(x,y)-a]+c&a\leq f(x,y)<b\\[2ex]\frac{c}{a} f(x,y)&0\leq f(x,y)<a\end{cases}$$

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081558582.png)

MATLAB中的`imadjust`将灰度图像 I 中的灰度值映射到新值中。

默认情况下，`imadjust` 对所有像素值中最低的 `1%` 和最高的 `1%` 进行抑制处理；将介于最低的 `1%` 和最高的 `1%` 之间的像素值进行**拉伸**。这意味着函数会忽略**最极端**的像素值，从而防止它们对整体图像的视觉效果产生不良影响。

## 1.3 代码

```matlab
img = imread("rice.png");

img_adjust = imadjust(img);
figure;
subplot(2, 2, 1);
imshow(img);
title('原始图像');
subplot(2, 2, 2);
imshow(img_adjust);
title('调整后的图像');
subplot(2, 2, 3);
imhist(img);
title('原始直方图');
subplot(2, 2, 4);
imhist(img_adjust);
title('调整后的直方图');
```

# 2.直方图修正

分类
- 直方图均衡化
- 直方图规定化

# 2.1 直方图

# 2.1.1 直方图定义

直方图(Histogram)：

反映一幅图像灰度级与出现这种灰度的概率之间关系的图形(某灰度级的像素个数)

- 横坐标是灰度级
- 纵坐标是该灰度级出现的频度
- 直方图是图像最基本的统计特征

# 2.1.2 直方图性质

- 不同图像可能具有同样的直方图，图像与直方图之间是多对一的映射关系

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081610996.png)

- 可叠加性，若将图像分区，则每个区都可分别作直方图，而原图像的总直方图为各区直方图之和
- 直方图是总体灰度的概念：
  - 总体**偏暗**的图像：
![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081612759.png)
  - 总体**偏亮**的图像：
![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081612295.png)
  - 总体**对比度偏低**的图像：
![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081613682.png)
  - 总体**对比度较高**的图像：
![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081613508.png)

--------------

总结：

![](https://cdn.jsdelivr.net/gh/oixel64/imgs/imgs/202405081614954.png)

